{
  "master": {
    "tasks": [
      {
        "id": "61",
        "title": "Review and polish Eclair UI for launch",
        "description": "Check for rough edges, verify interactions, ensure visual consistency",
        "details": "## Deliverable: Eclair UI polished and launch-ready\n\n### Context\nPRD Phase 9 (docs/project/PRD/active/PRD-phase-9-launch.md), Milestone 7, Deliverables D7.1-D7.4.\n\nReview Eclair visualizer for any rough edges, broken interactions, or visual inconsistencies before launch.\n\n### Key Decisions and Principles\n- No obvious bugs or broken features\n- Follows brand guidelines\n- Works on common screen sizes\n\n### Delivers\nEclair ready for public use.\n\n### Acceptance Criteria\n- Given demo URL pre-fill When Load clicked Then demo loads correctly\n- Given visualization When viewed Then no layout issues or broken styling\n- Given browser console When app used Then no errors logged\n- Given domain filtering When used Then filters work correctly\n- Given node selection When clicked Then selection highlights correctly\n- Given zoom/pan When used Then navigation works smoothly\n- Given brand guidelines When compared Then colors and typography match\n- Given different screen sizes When tested Then layout adapts reasonably\n\n### Dependencies\n- Task 57 (demo URL pre-fill configured)\n\n### Related Code\n- apps/eclair/src/\n- docs/brand/ — brand guidelines for comparison\n\n### Verification\n- nx serve eclair\n- Test all interactions manually\n- Check browser console for errors\n- Compare against brand guidelines\n- Test on different viewport sizes",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "57"
        ],
        "priority": "medium",
        "subtasks": [],
        "updatedAt": "2025-12-31T18:36:04.801Z"
      },
      {
        "id": "62",
        "title": "Refactor CI to tag-triggered npm publish",
        "description": "Change release workflow so npm publish only happens after git push succeeds. Use tag-triggered workflow instead of publishing in the same job as version bump.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": "63",
        "title": "Add --signature flags to CLI enrich command",
        "description": "Add --parameter and --return-type flags to enrich command for DomainOp components",
        "details": "## Deliverable: CLI enrich command supports method signatures\n\n### Context\nDuring extraction workflow testing, we found that the schema supports `signature` on DomainOp components, the builder supports it, and the UI displays it—but the CLI `enrich` command has no flags to add signatures.\n\nSchema definition (`packages/riviere-schema/src/schema.ts:16-19`):\n```typescript\nexport interface OperationSignature {\n  parameters?: OperationParameter[]\n  returnType?: string\n}\n```\n\nBuilder already supports it (`packages/riviere-builder/src/builder.ts:386`).\n\n### Key Decisions and Principles\n- Parameter format: `--parameter \"name:type\"` or `--parameter \"name:type:description\"`\n- Return type format: `--return-type <type>`\n- Flags are repeatable (like existing `--reads`, `--validates`, etc.)\n- Follow existing patterns in enrich.ts for parsing and validation\n\n### Delivers\nAbility to add method signatures when enriching DomainOp components via CLI.\n\n### Acceptance Criteria\n- Given DomainOp, When `--parameter \"orderId:string\"`, Then signature.parameters includes `{name: \"orderId\", type: \"string\"}`\n- Given DomainOp, When `--parameter \"orderId:string:The order ID\"`, Then signature.parameters includes `{name: \"orderId\", type: \"string\", description: \"The order ID\"}`\n- Given DomainOp, When `--return-type void`, Then signature.returnType is `\"void\"`\n- Given multiple `--parameter` flags, When command run, Then all parameters added to signature.parameters array\n- Given parameter format missing type (just `\"orderId\"`), When command run, Then validation error\n- Given empty parameter name (`\":string\"`), When command run, Then validation error\n\n### Dependencies\n- None (schema and builder already support signatures)\n\n### Related Code\n- `packages/riviere-cli/src/commands/builder/enrich.ts` — add new options and parsing\n- `packages/riviere-cli/src/commands/builder/enrich.spec.ts` — add tests\n- `packages/riviere-builder/src/builder-components.spec.ts:222` — example of signature in tests\n\n### Verification\n```bash\nnx test riviere-cli -- --testNamePattern \"enrich.*signature\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": "64",
        "title": "Reject duplicate values in builder enrich operations",
        "description": "Prevent duplicate entries when enriching components with state changes, business rules, and behavior",
        "details": "## Deliverable: Builder library rejects duplicate enrichment values\n\n### Context\nThe enrich command is intentionally additive (documented in step-5-enrich.md and CLI reference). However, when the same value is added twice, duplicates accumulate:\n\n```json\n\"stateChanges\": [\n  { \"from\": \"Draft\", \"to\": \"Placed\" },\n  { \"from\": \"Draft\", \"to\": \"Placed\" }  // duplicate\n]\n```\n\nThe builder library should silently skip values that already exist.\n\n### Key Decisions and Principles\n- Skip duplicates silently (no error, no warning) - additive semantics remain\n- Compare by value equality, not reference\n- Apply to all enrichment arrays: stateChanges, businessRules, behavior.reads/validates/modifies/emits\n\n### Delivers\nRunning `enrich` multiple times with the same values produces no duplicates.\n\n### Acceptance Criteria\n- Given component with stateChange Draft:Placed, When enrich called with Draft:Placed again, Then stateChanges array still has only one entry\n- Given component with businessRule \"X\", When enrich called with \"X\" again, Then businessRules array still has only one entry\n- Given component with reads \"this.state\", When enrich called with \"this.state\" again, Then behavior.reads still has only one entry\n- Given component with no enrichment, When enrich called with values, Then values are added normally\n- Given component with some values, When enrich called with mix of existing and new, Then only new values are added\n\n### Dependencies\n- None\n\n### Related Code\n- `packages/riviere-builder/src/builder.ts` — enrich method, around line 386\n- `packages/riviere-builder/src/builder.spec.ts` — add tests for duplicate rejection\n\n### Verification\n```bash\nnx test riviere-builder -- --testNamePattern \"enrich.*duplicate\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "low",
        "subtasks": []
      },
      {
        "id": "65",
        "title": "Add event schema extraction to CLI and workflow",
        "description": "Extract eventSchema from TypeScript event type definitions during extraction workflow",
        "details": "## Deliverable: Event schemas extracted from code and displayed in Eclair\n\n### Context\nThe Riviere schema supports `eventSchema` on Event components, and Eclair displays it. However:\n1. The CLI has no way to add eventSchema when adding Event components\n2. The extraction workflow doesn't capture event schemas from TypeScript types\n3. The demo app has event types defined but they weren't being extracted\n\nReference graph now has eventSchema populated manually. Need to automate this.\n\nDemo app event example (orders-domain/src/infrastructure/events.ts):\n```typescript\nexport type OrderPlaced = {\n  type: 'OrderPlaced'\n  orderId: string\n  customerId: string\n  items: Array<{ sku: string; quantity: number }>\n  totalAmount: number\n  timestamp: string\n}\n```\n\n### Key Decisions and Principles\n- Add --event-schema flag to add-component for Event type\n- Update extraction workflow step-2 to capture event schemas from TypeScript types\n- Schema format: TypeScript type literal string (e.g., \"{ orderId: string, timestamp: string }\")\n\n### Delivers\n1. CLI supports adding eventSchema when creating Event components\n2. Extraction workflow captures event schemas from code\n3. Demo app extraction produces graphs with event schemas\n\n### Acceptance Criteria\n- Given Event type, When add-component called with --event-schema, Then eventSchema is set on component\n- Given TypeScript event type definition, When step-2 extraction runs, Then eventSchema captured\n- Given demo app, When full extraction runs, Then all 9 events have eventSchema populated\n- Given Eclair, When viewing Event component, Then schema is displayed\n\n### Dependencies\n- None\n\n### Related Code\n- `packages/riviere-cli/src/commands/builder/add-component.ts` — add --event-schema option\n- `packages/riviere-cli/docs/workflow/step-2-*.md` — update extraction instructions\n- `packages/riviere-schema/src/schema.ts:85` — EventComponent.eventSchema\n\n### Verification\n```bash\nnx test riviere-cli -- --testNamePattern \"add-component.*event.*schema\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": "66",
        "title": "Add social media preview cards to eclair and docs apps",
        "description": "Design a branded social preview image (1200x630px) and add Open Graph/Twitter Card meta tags to both apps",
        "details": "## Deliverable: Add social media preview cards to eclair and docs apps\n\n### Context\nWhen links to eclair or docs are shared on social media (Twitter, LinkedIn, Slack), they display as a white box with just the website name. Neither app has Open Graph or Twitter Card meta tags configured.\n\nCurrent state:\n- Eclair: `/apps/eclair/index.html` — only has title, no OG/Twitter tags\n- Docs: `/apps/docs/.vitepress/config.ts` — has title/description, no OG/Twitter tags\n\n### Key Decisions\n- Create ONE dedicated social preview image used across all pages of both apps\n- Image dimensions: 1200x630px (optimal for OG/Twitter)\n- Design must follow brand guidelines in `/docs/brand/`\n\n### Delivers\n1. A branded social preview card image (1200x630px)\n2. Meta tags configured so shared links display rich previews\n\n### Acceptance Criteria\n- Given brand guidelines, When preview image designed, Then follows colors/typography/logo from `/docs/brand/`\n- Given preview image, When dimensions checked, Then is 1200x630px\n- Given eclair link shared on social media, When preview renders, Then shows branded image with title and description\n- Given docs link shared on social media, When preview renders, Then shows same branded image with title and description\n- Given Open Graph validator tool, When URL tested, Then all required tags present (og:title, og:description, og:image, og:url, og:type)\n\n### Dependencies\n- None\n\n### Related Code\n- `/docs/brand/` — brand guidelines (colors, logo, typography)\n- `/apps/eclair/index.html` — add meta tags to <head>\n- `/apps/docs/.vitepress/config.ts` — add to head array\n\n### Verification\n1. Test with https://www.opengraph.xyz/\n2. Test actual share on Twitter/LinkedIn/Slack",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "low",
        "subtasks": []
      },
      {
        "id": "67",
        "title": "Fix nav bar and sidebar alignment issues on docs site",
        "description": "Top nav border and sidebar border don't align; green artifacts visible at top corners",
        "details": "## Deliverable: Fix visual alignment issues on docs site header/sidebar\n\n### Context\nOn the docs site (living-architecture.dev), there are visual alignment issues:\n1. The horizontal line under the top nav bar doesn't align with the top of the left sidebar border\n2. Small green artifacts/lines visible at the top corners of the page (accent color leaking)\n\nScreenshot provided by user shows the issue on `/get-started/` page.\n\n### Key Decisions\n- This is a VitePress theme customization issue\n- Fix should be in custom CSS overrides\n\n### Delivers\nClean, aligned borders with no color artifacts\n\n### Acceptance Criteria\n- Given docs site loaded, When viewing header area, Then nav bar bottom border aligns with sidebar top\n- Given docs site loaded, When viewing top corners, Then no green artifacts visible\n- Given different viewport widths, When resizing, Then alignment remains consistent\n\n### Dependencies\n- None\n\n### Related Code\n- `/apps/docs/.vitepress/theme/` — custom theme overrides\n- `/apps/docs/.vitepress/config.ts` — VitePress config\n\n### Verification\n1. Visual inspection on living-architecture.dev after deploy\n2. Test at multiple viewport widths",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "low",
        "subtasks": []
      },
      {
        "id": "68",
        "title": "Set up Renovate and Knip",
        "description": "Configure Renovate for automated dependency updates and Knip for detecting unused files, dependencies, and exports",
        "details": "## Deliverable\nAutomated dependency updates and dead code detection for the monorepo.\n\n### Context\nThe monorepo currently lacks:\n- Automated dependency update tooling (dependencies go stale)\n- Unused code detection (dead code accumulates)\n\nRenovate automates dependency PRs. Knip finds unused files, dependencies, and exports.\n\n### Delivers\n1. Renovate configuration (renovate.json) at repo root - use GitHub Renovate App\n2. Knip configuration (knip.json or knip.ts) at repo root\n3. Knip integrated into verify gate\n\n### Acceptance Criteria\n- Given Renovate is configured, When a dependency has updates, Then Renovate creates a PR automatically\n- Given Knip is configured, When unused exports/dependencies exist, Then Knip reports them\n- Given Knip is in CI, When verify runs, Then unused code violations fail the build\n\n### Related Code\n- /package.json\n- /apps/*/package.json\n- /packages/*/package.json\n\n### Verification\n1. Run npx knip and verify it executes without config errors\n2. Verify Renovate dashboard shows repo is enabled",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": "69",
        "title": "Analyze and fix SonarCloud issues",
        "description": "Review existing SonarCloud issues and fix them to establish a clean baseline",
        "details": "## Context\nSonarCloud integration was added to CI. Before enforcing quality gates on new code, we should fix existing issues to establish a clean baseline.\n\n## Acceptance Criteria\n- [ ] Query SonarCloud for all current issues on main branch\n- [ ] Fix all CRITICAL and BLOCKER severity issues\n- [ ] Fix all MAJOR severity issues\n- [ ] Review and address any security hotspots\n- [ ] Verify quality gate passes on the PR\n\n## Technical Notes\nQuery issues:\n```bash\ncurl -s \"https://sonarcloud.io/api/issues/search?projectKey=NTCoding_living-architecture&severities=CRITICAL,BLOCKER,MAJOR\" | jq '.issues[] | {rule: .rule, message: .message, file: .component, line: .line}'\n```\n\nQuery security hotspots:\n```bash\ncurl -s \"https://sonarcloud.io/api/hotspots/search?projectKey=NTCoding_living-architecture\" | jq '.hotspots[] | {message: .message, file: .component, line: .line}'\n```\n\n## Test Strategy\n- All existing tests must pass\n- SonarCloud quality gate must pass on PR",
        "testStrategy": "",
        "status": "in-progress",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "updatedAt": "2026-01-01T18:41:50.418Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-01T18:41:50.418Z",
      "taskCount": 9,
      "completedCount": 1,
      "tags": [
        "master"
      ]
    }
  }
}