{
  "master": {
    "tasks": [
      {
        "id": 61,
        "title": "Review and polish Eclair UI for launch",
        "description": "Check for rough edges, verify interactions, ensure visual consistency",
        "details": "## Deliverable: Eclair UI polished and launch-ready\n\n### Context\nPRD Phase 9 (docs/project/PRD/active/PRD-phase-9-launch.md), Milestone 7, Deliverables D7.1-D7.4.\n\nReview Eclair visualizer for any rough edges, broken interactions, or visual inconsistencies before launch.\n\n### Key Decisions and Principles\n- No obvious bugs or broken features\n- Follows brand guidelines\n- Works on common screen sizes\n\n### Delivers\nEclair ready for public use.\n\n### Acceptance Criteria\n- Given demo URL pre-fill When Load clicked Then demo loads correctly\n- Given visualization When viewed Then no layout issues or broken styling\n- Given browser console When app used Then no errors logged\n- Given domain filtering When used Then filters work correctly\n- Given node selection When clicked Then selection highlights correctly\n- Given zoom/pan When used Then navigation works smoothly\n- Given brand guidelines When compared Then colors and typography match\n- Given different screen sizes When tested Then layout adapts reasonably\n\n### Dependencies\n- Task 57 (demo URL pre-fill configured)\n\n### Related Code\n- apps/eclair/src/\n- docs/brand/ — brand guidelines for comparison\n\n### Verification\n- nx serve eclair\n- Test all interactions manually\n- Check browser console for errors\n- Compare against brand guidelines\n- Test on different viewport sizes",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "57"
        ],
        "priority": "medium",
        "subtasks": [],
        "updatedAt": "2025-12-31T18:36:04.801Z"
      },
      {
        "id": 62,
        "title": "Refactor CI to tag-triggered npm publish",
        "description": "Change release workflow so npm publish only happens after git push succeeds. Use tag-triggered workflow instead of publishing in the same job as version bump.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 63,
        "title": "Add --signature flags to CLI enrich command",
        "description": "Add --parameter and --return-type flags to enrich command for DomainOp components",
        "details": "## Deliverable: CLI enrich command supports method signatures\n\n### Context\nDuring extraction workflow testing, we found that the schema supports `signature` on DomainOp components, the builder supports it, and the UI displays it—but the CLI `enrich` command has no flags to add signatures.\n\nSchema definition (`packages/riviere-schema/src/schema.ts:16-19`):\n```typescript\nexport interface OperationSignature {\n  parameters?: OperationParameter[]\n  returnType?: string\n}\n```\n\nBuilder already supports it (`packages/riviere-builder/src/builder.ts:386`).\n\n### Key Decisions and Principles\n- Parameter format: `--parameter \"name:type\"` or `--parameter \"name:type:description\"`\n- Return type format: `--return-type <type>`\n- Flags are repeatable (like existing `--reads`, `--validates`, etc.)\n- Follow existing patterns in enrich.ts for parsing and validation\n\n### Delivers\nAbility to add method signatures when enriching DomainOp components via CLI.\n\n### Acceptance Criteria\n- Given DomainOp, When `--parameter \"orderId:string\"`, Then signature.parameters includes `{name: \"orderId\", type: \"string\"}`\n- Given DomainOp, When `--parameter \"orderId:string:The order ID\"`, Then signature.parameters includes `{name: \"orderId\", type: \"string\", description: \"The order ID\"}`\n- Given DomainOp, When `--return-type void`, Then signature.returnType is `\"void\"`\n- Given multiple `--parameter` flags, When command run, Then all parameters added to signature.parameters array\n- Given parameter format missing type (just `\"orderId\"`), When command run, Then validation error\n- Given empty parameter name (`\":string\"`), When command run, Then validation error\n\n### Dependencies\n- None (schema and builder already support signatures)\n\n### Related Code\n- `packages/riviere-cli/src/commands/builder/enrich.ts` — add new options and parsing\n- `packages/riviere-cli/src/commands/builder/enrich.spec.ts` — add tests\n- `packages/riviere-builder/src/builder-components.spec.ts:222` — example of signature in tests\n\n### Verification\n```bash\nnx test riviere-cli -- --testNamePattern \"enrich.*signature\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 64,
        "title": "Reject duplicate values in builder enrich operations",
        "description": "Prevent duplicate entries when enriching components with state changes, business rules, and behavior",
        "details": "## Deliverable: Builder library rejects duplicate enrichment values\n\n### Context\nThe enrich command is intentionally additive (documented in step-5-enrich.md and CLI reference). However, when the same value is added twice, duplicates accumulate:\n\n```json\n\"stateChanges\": [\n  { \"from\": \"Draft\", \"to\": \"Placed\" },\n  { \"from\": \"Draft\", \"to\": \"Placed\" }  // duplicate\n]\n```\n\nThe builder library should silently skip values that already exist.\n\n### Key Decisions and Principles\n- Skip duplicates silently (no error, no warning) - additive semantics remain\n- Compare by value equality, not reference\n- Apply to all enrichment arrays: stateChanges, businessRules, behavior.reads/validates/modifies/emits\n\n### Delivers\nRunning `enrich` multiple times with the same values produces no duplicates.\n\n### Acceptance Criteria\n- Given component with stateChange Draft:Placed, When enrich called with Draft:Placed again, Then stateChanges array still has only one entry\n- Given component with businessRule \"X\", When enrich called with \"X\" again, Then businessRules array still has only one entry\n- Given component with reads \"this.state\", When enrich called with \"this.state\" again, Then behavior.reads still has only one entry\n- Given component with no enrichment, When enrich called with values, Then values are added normally\n- Given component with some values, When enrich called with mix of existing and new, Then only new values are added\n\n### Dependencies\n- None\n\n### Related Code\n- `packages/riviere-builder/src/builder.ts` — enrich method, around line 386\n- `packages/riviere-builder/src/builder.spec.ts` — add tests for duplicate rejection\n\n### Verification\n```bash\nnx test riviere-builder -- --testNamePattern \"enrich.*duplicate\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "low",
        "subtasks": []
      },
      {
        "id": 65,
        "title": "Add event schema extraction to CLI and workflow",
        "description": "Extract eventSchema from TypeScript event type definitions during extraction workflow",
        "details": "## Deliverable: Event schemas extracted from code and displayed in Eclair\n\n### Context\nThe Riviere schema supports `eventSchema` on Event components, and Eclair displays it. However:\n1. The CLI has no way to add eventSchema when adding Event components\n2. The extraction workflow doesn't capture event schemas from TypeScript types\n3. The demo app has event types defined but they weren't being extracted\n\nReference graph now has eventSchema populated manually. Need to automate this.\n\nDemo app event example (orders-domain/src/infrastructure/events.ts):\n```typescript\nexport type OrderPlaced = {\n  type: 'OrderPlaced'\n  orderId: string\n  customerId: string\n  items: Array<{ sku: string; quantity: number }>\n  totalAmount: number\n  timestamp: string\n}\n```\n\n### Key Decisions and Principles\n- Add --event-schema flag to add-component for Event type\n- Update extraction workflow step-2 to capture event schemas from TypeScript types\n- Schema format: TypeScript type literal string (e.g., \"{ orderId: string, timestamp: string }\")\n\n### Delivers\n1. CLI supports adding eventSchema when creating Event components\n2. Extraction workflow captures event schemas from code\n3. Demo app extraction produces graphs with event schemas\n\n### Acceptance Criteria\n- Given Event type, When add-component called with --event-schema, Then eventSchema is set on component\n- Given TypeScript event type definition, When step-2 extraction runs, Then eventSchema captured\n- Given demo app, When full extraction runs, Then all 9 events have eventSchema populated\n- Given Eclair, When viewing Event component, Then schema is displayed\n\n### Dependencies\n- None\n\n### Related Code\n- `packages/riviere-cli/src/commands/builder/add-component.ts` — add --event-schema option\n- `packages/riviere-cli/docs/workflow/step-2-*.md` — update extraction instructions\n- `packages/riviere-schema/src/schema.ts:85` — EventComponent.eventSchema\n\n### Verification\n```bash\nnx test riviere-cli -- --testNamePattern \"add-component.*event.*schema\"\n```",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2025-12-31T18:36:04.802Z",
      "taskCount": 2,
      "completedCount": 1,
      "tags": [
        "master"
      ],
      "created": "2025-12-31T18:44:27.260Z",
      "description": "Tasks for master context",
      "updated": "2025-12-31T18:59:27.052Z"
    }
  }
}